library(NVIcheckmate)
library(testthat)
library(checkmate)
context("check_subset_anycase")

test_that("No error for check_subset_anycase", {

  expect_identical(
    check_subset_anycase(x = "apple",
                         choices = c("Apple", "Pear", "Orange", "Banana")),
    TRUE)
expect_identical(
    check_subset_anycase(x = "bAnAnA",
                         choices = c("Apple", "Pear", "Orange", "Banana")),
    TRUE)
expect_identical(
    check_subset_anycase(x = c("apple", "pear"),
 choices = c("Apple", "Pear", "Orange", "Banana")),
    TRUE)
} )

test_that("Make error for check_subset_anycase", {
  expect_identical(
    check_subset_anycase(x = "Tomato",
                         choices = c("Apple", "Pear", "Orange", "Banana")),
    "Must be element of set {'Apple','Pear','Orange','Banana'} (case insensitive), but is 'Tomato'")
expect_identical(
    check_subset_anycase(x = c("Tomato", "Apple"), 
                         choices = c("Apple", "Pear", "Orange", "Banana")),
    "Must be element of set {'Apple','Pear','Orange','Banana'} (case insensitive), but is {'Tomato', 'Apple'}")
})
